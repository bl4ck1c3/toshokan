<% if has_user_authentication_provider? and current_user %>
  <% if can? :logout, User %>
    <%= t('toshokan.header_links.logged_in_as') %> <%= link_to current_user, edit_user_registration_path %>
    <% if can? :switch, User %>
      [ <%= link_to t('toshokan.header_links.switch_user'), switch_user_path, :id => 'switch_user' %> ]
      <div id="switch_user_form" class="ajax" style="display:none">
        <% # This is the thing the ajaxified 'switch user' will show %>
        <a class="cancel" href="">Cancel</a>
        <h4><%= t 'toshokan.header_links.switch_user' %></h4>
        <%= render '/users/sessions/switch_user_form' %>
      </div>
    <% elsif can? :switch_back, User %>
      [ <%= link_to t('toshokan.header_links.switch_back'), user_session_path, :method => :put, :id => 'switch_back' %> ]
    <% end %>
    |
    <% if can? :update, User %>
      <%= link_to t('toshokan.header_links.admin'), users_path %>
      |
    <% end %>
    <%= link_to t('blacklight.header_links.bookmarks'), bookmarks_path %>
    |
    <%= link_to t('blacklight.header_links.saved_searches'), saved_searches_path %>
  <% end %>
|
<% end %>
<%= link_to t('blacklight.header_links.search_history'), search_history_path %>
<% if can? :login_cas, User %>
  |
  <%= link_to t('toshokan.header_links.login_cas'), new_user_session_path(:return_url => u(request.url)) %>
<% end %>
<% if can? :login_velo, User %>
  |
  <%= link_to t('toshokan.header_links.login_velo'), new_user_session_path(:return_url => u(request.url)) %>
<% end %>
<% if can? :logout_cas, User %>
  |
  <%= link_to t('toshokan.header_links.logout_cas'), destroy_user_session_path %>
<% end %>
<% if can? :logout_velo, User %>
  |
  <%= link_to t('toshokan.header_links.logout_velo'), destroy_user_session_path %>
<% end %>
