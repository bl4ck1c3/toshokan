
<%= render :partial => 'shared/mylib_menu' %>

<div id="content" class="span9">

  <h3><%=t('toshokan.mylibrary.menu.search_history')%></h3>

  <%- if @searches.blank? -%>
    <div class="alert alert-info"><%=t('blacklight.search_history.no_history')%></div>
  <%- else -%>

    <table class="table table-hover">
      <thead>
        <tr>
          <th>Title</th>
          <th>Search</th>
          <th>Issued</th>
          <th class="action"><%= t('toshokan.mylibrary.info') %></th>
          <th class="action"><%= t('toshokan.mylibrary.save') %></th>
          <th class="action"><%= t('toshokan.mylibrary.alert') %></th> 
          <th class="action"><%= t('toshokan.mylibrary.delete') %></th>
        </tr>
      </thead>
      <% @searches.each do |search| %>
        <tr class="history-item">
          <td><em class="muted">Add title</em></td>
          <td><%= link_to_previous_search(search.query_params) %></td>
          <td><%= search.created_at.to_s(:long) %></td>
          <td class="action">
            <%= link_to "#", method: :show , :title => "t('toshokan.mylibrary.info')" do %>
              <i class="icon-info-sign"></i>
            <% end %>
          </td>
          <td class="action">
            <%- if !search.saved -%>
              <%= link_to save_search_path(search.id), :method => :put, :title => t('toshokan.mylibrary.save') do %>
                <i class="icon-star-empty"></i>
              <%- end -%>
            <%- else -%>
              <%= link_to forget_search_path(search.id), :method => :delete, :title => t('toshokan.mylibrary.saved') do %>       
                <i class="icon-star"></i>
              <%- end -%>
            <%- end -%>
          </td>
          <td class="action">
            <%- if !search.alerted -%>
              <%= link_to save_search_alert_path(search.id), :method => :put, :title => 
              t('toshokan.mylibrary.alert') do %>
                <i class="icon-bell"></i>
              <%- end -%>
            <%- else -%>
              <%= link_to forget_search_alert_path(search.id), :method => :delete, :title =>
              t('toshokan.mylibrary.alerted') do %> 
                <i class="icon-bell-alt"></i>
              <%- end -%>
            <%- end -%>
          </td>          
          <td class="action">
            <%= link_to delete_search_history_path(search.id), method: :delete, :title => t('toshokan.mylibrary.delete') do %>
              <i class="icon-remove"></i>
            <% end %>
        </td>
        </tr>
      <% end %>
    </table>
  <%- end -%>
 
</div>